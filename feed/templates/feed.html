{% load static %}
{% static "images" as baseURL %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <h1>Feed Page</h1>
    <li><a href="{% url 'profilepage' request.user.username %}">Profile</a></li>
    <li><a href="{% url 'favorites' %}">Favorite Posts</a></li>

    <!-- Upload box -->
    <div class="upload">

        <div>
            <form action="{% url 'upload' %}" method="POST" enctype="multipart/form-data">
                {% csrf_token %}
                <input type="file" name="image" accept="image/*" value="Image "><br>  <!-- For image -->
                <input type="file" name="video" accept="video/*" value="Video"><br>  <!-- For video -->
                <textarea name="caption" cols="20" rows="5" placeholder="Your Caption"></textarea><br>
                <input type="submit" value="Upload">
            </form>
        </div>
    </div>
    <br>

    <!-- Feed posts -->
    <div>
            <!-- feed/feed.html -->
        {% for post in posts reversed %}
        <div>
            <!-- username -->
            <h3><a href="{% url 'profilepage' post.user.username %}">{{ post.user }}</a></h3>
        </div>
                 <!-- <h3>{{ post.user }}</h3> -->
            
        </div>
        <div>
            <!-- profile image -->
            <a href="{% url 'profilepage' post.user.username %}">
                <img src="{{ post.user.profile.profileimg.url }}" alt="" width="50" height="50">
            </a>

            <!-- post image -->
            <a href="{{ post.image.url }}">
                <img src="{{ post.image.url }}" alt="" width="200" height="200">
            </a>
            <p>{{ post.created_at }}</p>
        </div>
        <div>
            <p>{{ post.caption }}</p>
        </div>

        <!-- Like button -->
        <div>
            <form action="{% url 'like_post' post.id %}" method="POST" style="display: inline;">
                {% csrf_token %}
                <button type="submit">
                    {% if request.user in post.likes.all %}
                        Unlike
                    {% else %}
                        Like
                    {% endif %}
                </button>
            </form>
                <a href="{{ post.image.url }}" download style="display: inline-block; margin-left: 10px;">
                    <button>Download</button>
                </a>

                        <!-- Post Favorite -->
            {% if request.user.is_authenticated %}
                {% if post not in request.user.profile.favorites.all %}
                    <form action="{% url 'add_to_favorites' post.id %}" method="post">
                        {% csrf_token %}
                        <button type="submit">Add to Favorites</button>
                    </form>
                {% else %}
                    <form action="{% url 'remove_from_favorites' post.id %}" method="post">
                        {% csrf_token %}
                        <button type="submit">Remove from Favorites</button>
                    </form>
                {% endif %}
            {% endif %}



                <!-- likes count -->
            <p>{{ post.likes.count }} Likes</p>
        </div>
        {% endfor %}
    </div>
    


</body>
</html>